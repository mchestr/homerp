renovate:
  stage: .pre
  image: renovate/renovate:latest
  variables:
    RENOVATE_PLATFORM: gitlab
    RENOVATE_ENDPOINT: ${CI_API_V4_URL}
    RENOVATE_TOKEN: ${RENOVATE_TOKEN}
    RENOVATE_REPOSITORIES: ${CI_PROJECT_PATH}
    RENOVATE_CONFIG_FILE: .gitlab/renovate.json
    LOG_LEVEL: info
  script:
    - renovate
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule" && $RENOVATE_SCHEDULE == "true"
    - if: $CI_PIPELINE_SOURCE == "web" && $RENOVATE_RUN == "true"
